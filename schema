-- Create a schema for our lab 
CREATE SCHEMA ecommerce; 

-- Create customers table 
CREATE TABLE ecommerce.customers ( 
    customer_id INT PRIMARY KEY, first_name VARCHAR(50), 
    last_name VARCHAR(50), email VARCHAR(100), 
    signup_date DATE, country VARCHAR(50), 
    city VARCHAR(50) 
) 
DISTSTYLE EVEN; 
    
-- Create products table 
CREATE TABLE ecommerce.products ( 
    product_id INT PRIMARY KEY, product_name VARCHAR(200), 
    category VARCHAR(50), price DECIMAL(10,2), 
    supplier VARCHAR(100) 
) 
DISTSTYLE ALL; 
    
-- Create orders table with distribution and sort keys 
CREATE TABLE ecommerce.orders ( 
    order_id INT PRIMARY KEY, customer_id INT, 
    order_date DATE, total_amount DECIMAL(10,2), 
    order_status VARCHAR(20) 
) 
DISTKEY(customer_id) SORTKEY(order_date); 
    
-- Create order items table 
CREATE TABLE ecommerce.order_items ( 
    order_item_id INT PRIMARY KEY, order_id INT, 
    product_id INT, quantity INT, unit_price DECIMAL(10,2), 
    discount_percent DECIMAL(5,2) 
) 
DISTKEY(order_id) SORTKEY(order_id, product_id);
