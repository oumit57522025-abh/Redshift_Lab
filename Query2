SELECT p.product_name, p.category, COUNT(oi.order_item_id) AS times_ordered, SUM(oi.quantity) AS total_quantity, SUM(oi.quantity * oi.unit_price * (1 - oi.discount_percent/100)) AS total_revenue FROM ecommerce.order_items oi JOIN ecommerce.products p ON oi.product_id = p.product_id GROUP BY p.product_name, p.category ORDER BY total_revenue DESC LIMIT 5;
