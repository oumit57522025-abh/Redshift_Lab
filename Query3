SELECT c.customer_id, c.first_name || ' ' || c.last_name AS customer_name, c.country, COUNT(DISTINCT o.order_id) AS total_orders, SUM(o.total_amount) AS lifetime_value, AVG(o.total_amount) AS avg_order_value, MIN(o.order_date) AS first_order_date, MAX(o.order_date) AS last_order_date FROM ecommerce.customers c JOIN ecommerce.orders o ON c.customer_id = o.customer_id GROUP BY c.customer_id, customer_name, c.country ORDER BY lifetime_value DESC;
